#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
    File:   modules/localtunnel.py
    Author: codeuk
    Date:   18/07/2022
    Python: 3.10
"""

from threading import Timer
from os import system

class Localtunnel:
    """ Use npm's 'localtunnel' to enable connections over wifi """

    @staticmethod
    def start(app):
        old_run = app.run

        def StartLT(port: str):
            print(system(f'lt -p {port}'))

        def NewRun(*args, **kwargs):
            port = kwargs.get('port', 5000)
            thread = Timer(1, StartLT, args=(port,))
            thread.setDaemon(True)
            thread.start()
            old_run(*args, **kwargs)
        app.run = NewRun