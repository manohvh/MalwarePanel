import os
from threading import Timer

""" Install localtunnel using npm and start panel connector on port 5000 using lt """

def run_lt(port):
    output = os.system(f'lt -p {port}')
    return output

def start_lt(port):
    print(run_lt(port))

def start(app):
    old_run = app.run

    def new_run(*args, **kwargs):
        port = kwargs.get('port', 5000)
        thread = Timer(1, start_lt, args=(port,))
        thread.setDaemon(True)
        thread.start()
        old_run(*args, **kwargs)
    app.run = new_run
